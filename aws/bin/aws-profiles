#!/usr/bin/env bash

# AWS Profiles command
# ====================
# Tim Friske <me@tifr.de>
#
# Lists the names of the configured AWS profiles, alphanumerically sorted.
# Optionally filters the list by one or more given extended regular expressions.
#
# Deps:: aws, bash, cat, env, grep, sort

# Ensure fail-fast script execution.
shopt -os nounset pipefail errexit errtrace

aws configure list-profiles \
| case "$(("${#}"))" in
    0) cat;;
    1) grep --extended-regexp --regexp="${1}";;
    *) grep --extended-regexp --file=<(printf '%s\n' "${@}");;
  esac \
| sort
